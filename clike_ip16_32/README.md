# Bitlet--CLike版本

## 整体框架及各模块功能
### 整体结构和各模块关系
本IP顶层模块为主函数，另外有6个模块分别执行不同的功能。这些模块分别是IEEE754转换模块，负数补码转换模块，emax模块，shiftOrchest模块，decoder模块，adder_Tree模块以及post_process模块。各模块间的关系及功能会在下文展示。


### 主函数模块变量描述
顶层模块变量如表1.1所示

`表1. 1 变量描述`
变量名称 |	类型  |	功能
--------|--------|-----
weight |	Int	|输入变量
active  |	Int	| 输入变量
mac_result_software	| Int | 	该变量用软件算出mac结果用于比对bitlet结果的正确性。
exp	 | Int	| 该变量用于存储指数
weight_ieee754	| String	| 用于存储将weight转换成ieee754标准的10字符串
active_ieee754	| String| 用于存储将active转换成ieee754标准的1、0字符串
sign	| Int	| 该信号用于存储符号
exp_Max	| Int | 该信号用于连接expmax_moudle
w_manti_list | 	String | 	该信号用于存储w的尾数
a_manti_list |	String	| 该信号用于存储a的尾数
sewo	| Int	| 该信号用于连接shiftOrchest模块
outnum	| Int	| 该信号用于连接decoder模块

### 主要功能
主函数模块首先对输入的weight和active进行处理，使其变成ieee754标准下的字符串，然后将其符号和指数存储下来，进行后续操作。

## IEEE754转换模块

### 变量描述
变量情况如表2.1所示。

`表2. 1 变量功能描述`

变量名称 |	类型 |	功能
--------|--------|-----
aa	| Float| 	输入信号
z	| Int	| 输出信号

### 功能描述
该模块将输入进来的浮点数按照IEEE754标准转换成字符串。

## Twos_complemeng模块
### 变量描述
如表3.1所示。

`表3. 1 变量描述`

变量名称 |	类型 |	功能
--------|--------|-----
Inverted_str |	string |	对字符串每个字符取反。
Inverted_num |	string |	将取反后的字符串转成整数并且加一
bin_str |	string |	输入信号

### 功能描述
如果该数是负数，则求其补码需要用到这个函数，作用是将此负数转换成其补码的格式

## expmax_moudle模块

### 变量描述
变量描述如表4.1所示。

`表4. 1 变量描述`

变量名称 |	类型 |	功能
--------|--------|-----
exp | 	Int |	输入所有数的指数
expMax |	Int	 |在所有指数中选取最大的并保存

### 功能描述
该模块将所有数的指数输入，选取一个最大的并输出。 

 
## decoder_moudle模块

###  变量描述
变量描述如表5.1所示。

``表5 1 变量描述``

变量名称 |	类型 |	功能
--------|--------|-----
Shift_a_manti |	String |	根据第几个decoder对a的尾数进行相应的移位
Int_Shift_a_manti |	Int |	将string类型的a的尾数转换成int，方便后面相加操作
result_num	 |Int |	作为加和的中间结果
result_num_list |	int |	将加和的结果聚集起来作为输出

### 功能描述
该模块用于计算O_i,向该模块输入重排列的权重尾数的相同位(Shift_num位)和激活值尾数，通过滑窗在权重尾数上移动，检测滑窗是否有必要位1，如果有的话，记录位置，可以知道是第几个权重，将该权重相对应的激活值尾数相加，最后得到32*8的列表。

## Add_tree模块

### 变量描述
变量描述如表6.1所示。

``表6 1 变量描述``

变量名称 |	类型 |	功能
--------|--------|-----
result |	Int	 |计算累加的结果

### 功能描述
该模块对输入的8*24个数做加和操作，每次将数加到result里面，所有数均已输入并计算完毕，此时将result的值输出。

## post_process_moudle模块
### 变量描述
变量描述如表7.1所示

``表7.1变量描述``

变量名称 |	类型 |	功能
--------|--------|-----
data_sign |	string |	判断该数是正数还是负数
result |	int |	输入进来的数如果是负数，要变成其补码
cnt |	int |	计数器，计数第一个1的位置
data_manti |	string |	最后结果的尾数
offste |	int |	最后结果的指数的偏移
data_exp |	int |	最后结果的指数
data |	string |	完整的ieee754标准下的结果

### 功能描述
本模块用于后处理得到的结果，首先提取结果的符号，将得到的尾数按照补码形式转换，而后从高到低找到ieee754中隐藏的1位将其隐藏，接下来对结果的尾数按偏移进行左移或右移得到正确指数下的尾数，最后将符号位，指数以及尾数拼接到一起得到正确的结果。
